# 支出先CSV構造分析レポート

**調査日**: 2026-02-21
**対象ファイル**: `data/year_2024/5-1_RS_2024_支出先_支出情報.csv`
**使用スクリプト**: `scripts/split-spending-csv.ts`、`scripts/analyze-recipients-no-total.ts`、`scripts/analyze-other-recipients.ts`

---

## CSV行の分類

### 全体の行数内訳

| 区分 | 行数 |
|---|---|
| ブロック集計行 | 19,783 行 |
| 個別支出先行（合計支出額 あり） | 74,760 行 |
| 個別支出先行（合計支出額 なし） | 98,599 行 |
| スキップ（支出先名・ブロック名が両方空） | 991 行 |
| **合計** | **194,133 行** |

### 分類ロジック

| 行種別 | 判定条件 |
|---|---|
| ブロック集計行 | `支出先名` が空 かつ `支出先ブロック名` が存在 |
| 個別支出先行 | `支出先名` が存在 |
| スキップ | `支出先名`・`支出先ブロック名` が両方空 |

`個別支出先行` は `支出先の合計支出額` の有無でさらに分割される。

---

## 個別支出先行（合計支出額 あり）: 74,760 行

### 特徴

- `支出先の合計支出額` カラムに値がある行
- 同一支出先・同一ブロック内に複数の契約行がある場合の**集計エントリ**
- 法人番号・法人種別コードが揃っていることが多い

---

## 個別支出先行（合計支出額 なし）: 98,599 行 の深堀り

### 統計

| 指標 | 値 |
|---|---|
| 支出先名ユニーク数 | 26,192 件 |
| 法人番号なし（ユニーク支出先名） | 6,988 件 |
| その他支出先=TRUE（ユニーク支出先名） | 970 件 |

`その他支出先` カラムの値は `"TRUE"` / `"FALSE"` の2値。

### 法人番号なし TOP10（合計金額順）

| 支出先名 | 事業数 | 合計金額（概算） |
|---|---|---|
| その他 | 1,572 | 259,587億円 |
| 年金受給者 | 2 | 246,944億円 |
| 年金受給者等 | 2 | 238,440億円 |
| その他都道府県・市及び福祉事務所を設置する町村 | 2 | 20,019億円 |
| 求職者等 | 1 | 19,425億円 |
| その他の市区町村 | 2 | 12,000億円 |
| 児童手当の受給者 | 1 | 11,482億円 |
| その他の県 | 2 | 6,435億円 |
| その他事業者 | 1 | 6,284億円 |
| 農業者等 | 7 | 5,997億円 |

**解釈**: `年金受給者`・`求職者等`・`農業者等` などは個人への給付金（法人番号なしは当然）。
`その他〜` 系は地方交付税等の広域一括計上エントリ。

### その他支出先=TRUE TOP10（合計金額順）

| 支出先名 | 事業数 | 合計金額（概算） |
|---|---|---|
| その他 | 1,549 | 259,546億円 |
| その他都道府県・市及び福祉事務所を設置する町村 | 2 | 20,019億円 |
| その他の市区町村 | 2 | 12,000億円 |
| その他の県 | 2 | 6,435億円 |
| その他事業者 | 1 | 6,284億円 |
| その他の支出先 | 52 | 3,811億円 |
| その他支出先 | 4 | 2,496億円 |
| 業務経費 | 3 | 1,702億円 |
| 示達 | 1 | 1,402億円 |
| 民間事業者等 | 4 | 1,401億円 |

**解釈**: `業務経費`・`示達` は会計処理上の概念的エントリ（特定の支出先ではない）。

---

## 考察

### 合計支出額なし行の主要パターン

1. **個人給付系**: `年金受給者`・`求職者等`・`農業者等` など → 法人番号なし、多額、事業数少
2. **「その他」集約系**: `その他`・`その他の県`・`その他の市区町村` → フラグ=TRUE、集約された残余分
3. **会計処理エントリ**: `業務経費`・`示達` → 特定の法人ではなく経費科目

### タグ分類への示唆

- `年金受給者`・`求職者等` 等の給付対象者名は `その他` タグの対象（法人ではない）
- `その他支出先=TRUE` の行はブラウザ非表示または集約表示の候補
- `合計支出額 なし` 行はそのままタグ分類対象にすると精度が下がる可能性あり

---

## 「その他」フラグの関係性分析

### 1. `その他の契約` × `その他支出先` × `合計支出額` クロス集計（全個別支出先行 173,359 行）

| その他の契約 | その他支出先 | 合計支出額 | 行数 |
|---|---|---|---|
| (空) | FALSE | **あり** | 69,915 |
| (空) | FALSE | なし | 398 |
| (空) | TRUE | **あり** | 4,845 |
| (空) | TRUE | なし | 42 |
| FALSE | FALSE | なし | 89,810 |
| FALSE | TRUE | なし | 3,104 |
| TRUE | FALSE | なし | 2,810 |
| TRUE | TRUE | なし | 2,435 |

- `その他の契約=TRUE` 合計: 5,245 行
- `その他支出先=TRUE` 合計: 10,426 行
- 両方 TRUE: 2,435 行（`その他の契約=TRUE` の約46%）

**→ `合計支出額あり` の行（74,760行）は全て `その他の契約=(空)`。**
`その他の契約=FALSE` または `TRUE` が付いている行には `合計支出額` が存在しない。
つまり `その他の契約` フラグは集計行（合計支出額あり）には記入されず、個別明細行（合計支出額なし）にのみ現れる。

#### `その他の契約=(空)` × `合計支出額=なし` の 440 行（異常行）について

当初 `シート種別=レビューシート` を根拠に「レビューシート専用行」と解釈したが、**全行が `レビューシート`** であるためこの判断は誤りだった。

実態調査の結果:
- 440行 = 199ペア（FALSE側）+ 21ペア（TRUE側）の **全フィールド完全一致の純粋な重複行**
- 金額・合計支出額・ブロック合計・支出先の数が **全て空**
- 組織情報（事業ID・府省庁・ブロック番号・支出先名）のみ存在

**解釈**: RSシステムの出力バグまたは入力不備により、財務データなしで支出先名だけが2行ずつ記録されたエントリ。集計・タグ分類への影響はない（金額が空のため）。

### 2. `その他支出先=TRUE`（具体的な社名・CN なし）と同ブロック「その他」行の関係

**調査条件**: `その他支出先=TRUE` かつ `支出先名 ≠ 「その他」` かつ `法人番号 = 空`

| 指標 | 値 |
|---|---|
| 対象行数 | 3,542 行 |
| 同ブロックに「その他」行あり | 817 行 |
| 同ブロックに「その他」行なし | 827 ブロック |

**典型例（事業ID=140, ブロックA）**:

```
支出先名=エルゼビア・ジャパン株式会社  金額=0  その他支出先=TRUE  CN=なし
支出先名=クラリベイト・アナリティクス  金額=0  その他支出先=TRUE  CN=なし
支出先名=紀伊國屋書店                金額=0  その他支出先=TRUE  CN=なし
  ...（同ブロック内の他社も同様）
支出先名=その他                       金額=256,585,000円         ← 上記をまとめた実計上行
```

**構造の解釈**:

`その他支出先=TRUE` の金額0行は **「このブロックにはこの会社も含まれるが金額は『その他』に一括計上」** という申告用の名前リスト行。実際の支出金額は同ブロックの `支出先名=その他` 行に集約されている。

- 金額完全一致: 0件（1つの「その他」行が複数社分をまとめているため当然）
- `その他の契約` フラグとの相関も弱く、この行パターンはフラグ分類に依存しない独自の構造

**→ タグ分類・集計時の取り扱い方針**: これらの金額0行を個別支出先として合計すると二重計上になる。`金額=0` かつ `その他支出先=TRUE` の組み合わせは表示用の名前列挙として扱い、金額集計から除外が必要。

---

## 出力ファイル（`data/result/`）

| ファイル | 内容 |
|---|---|
| `blocks.csv` | 支出先ブロック集計行（19,783行） |
| `recipients_with_total.csv` | 個別支出先行・合計額あり（74,760行） |
| `recipients_without_total.csv` | 個別支出先行・合計額なし（98,599行） |
| `skipped.txt` | スキップ行・理由付き（991行） |
| `no_total_stats.txt` | 合計額なし行の統計サマリー |
| `no_total_no_cn.csv` | 法人番号なし支出先名リスト（合計金額・事業数付き） |
| `no_total_other_flag.csv` | その他支出先=TRUE支出先名リスト（合計金額・事業数付き） |
| `other_analysis.txt` | その他フラグ関係性分析（クロス集計・同ブロック照合） |
