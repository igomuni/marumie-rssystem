# 現在のサンキー図ノードクリック時の挙動

`app/sankey/page.tsx` の `handleNodeClick` 実装に基づく現在の遷移仕様です。

## 1. ノードタイプ別の挙動

### 予算総計 (`total-budget`)
- **府省庁ビュー表示時**: 全体ビューへ戻る
- **全体ビュー表示時 (2ページ目以降)**: 前のページへ戻る (オフセットを減らす)
- **それ以外**: 何もしない

### 府省庁ノード (`ministry-budget`)
- **府省庁ビュー表示時**: **全体ビューへ戻る** (※ここが違和感の元)
- **支出ビュー表示時**: その府省庁の「府省庁ビュー」へ遷移
- **全体ビュー/事業ビュー表示時**: その府省庁の「府省庁ビュー」へ遷移

### 事業ノード (`project-budget`, `project-spending`)
- **「事業(TopN以外)」の場合**:
  - 全体ビュー: 府省庁のオフセットを増やす (次のページへ)
  - 府省庁ビュー: 事業のオフセットを増やす (次のページへ)
  - 支出ビュー: 事業のオフセットを増やす (次のページへ)
- **事業ビュー表示時**: 前のビューへ戻る (府省庁ビュー または 全体ビュー)
- **支出ビュー表示時**: その事業の「事業ビュー」へ遷移
- **全体ビュー/府省庁ビュー表示時**: その事業の「事業ビュー」へ遷移

### 支出先ノード (`recipient`)
- **「その他」の場合**: 「その他」の支出ビューへ遷移
- **「支出先(TopN以外)」の場合**: 支出先のオフセットを増やす (次のページへ)
- **支出ビュー表示時**: 前のビューへ戻る (事業ビュー / 府省庁ビュー / 全体ビュー)
- **それ以外**: その支出先の「支出ビュー」へ遷移

## 2. 特殊ノードの挙動

### その他の府省庁 (`ministry-budget-other`)
- **常に**: 府省庁のオフセットを増やす (次のページへ)

## 3. 課題点 (User Feedback)

> 今`府省庁ビュー`で`府省庁`ノードクッリクして`全体ビュー`に遷移するの違和感があります

現在の実装では、詳細ビュー（府省庁ビューなど）で、そのビューの主役となるノード（府省庁ノード）をクリックすると「戻る」動作になっています。
これが直感的でない可能性があります。

## 4. 改善案の検討用メモ

- **現状**: トグル的な動作（開く⇔閉じる）を意図している。
- **違和感の原因**: 「詳細を見ているのに、そのタイトル的なノードをクリックしたら消えてしまう」感覚？
- **代替案**:
  - 何もしない (クリック無効化)
  - ツールチップで情報を出すのみにする
  - 明示的な「× 閉じる」ボタンやパンくずリストでの戻りを推奨する
