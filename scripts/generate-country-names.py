#!/usr/bin/env python3
"""
日本語国名リスト（正式名称 + 通称・別名）を CSV で生成する。
出力: data/result/country_names.csv
列: country_id, canonical_name, name, name_type (canonical/alias)
"""

import csv
import os

OUT_PATH = os.path.join(os.path.dirname(__file__), '..', 'data', 'result', 'country_names.csv')

# (country_id, canonical_name, [aliases...])
# canonical_name は外務省が用いる正式名称
COUNTRIES = [
    # === アジア ===
    ("jp", "日本国", ["日本"]),
    ("cn", "中華人民共和国", ["中国"]),
    ("kr", "大韓民国", ["韓国", "南朝鮮"]),
    ("kp", "朝鮮民主主義人民共和国", ["北朝鮮", "北韓"]),
    ("tw", "中華民国", ["台湾"]),  # ※外交上の扱いは特殊
    ("mn", "モンゴル国", ["モンゴル"]),
    ("vn", "ベトナム社会主義共和国", ["ベトナム", "越南"]),
    ("la", "ラオス人民民主共和国", ["ラオス"]),
    ("kh", "カンボジア王国", ["カンボジア"]),
    ("th", "タイ王国", ["タイ"]),
    ("mm", "ミャンマー連邦共和国", ["ミャンマー", "ビルマ"]),
    ("my", "マレーシア", []),
    ("sg", "シンガポール共和国", ["シンガポール"]),
    ("id", "インドネシア共和国", ["インドネシア"]),
    ("ph", "フィリピン共和国", ["フィリピン"]),
    ("tl", "東ティモール民主共和国", ["東ティモール", "ティモール・レスト"]),
    ("bn", "ブルネイ・ダルサラーム国", ["ブルネイ"]),
    ("in", "インド", ["インド共和国"]),
    ("pk", "パキスタン・イスラム共和国", ["パキスタン"]),
    ("bd", "バングラデシュ人民共和国", ["バングラデシュ"]),
    ("lk", "スリランカ民主社会主義共和国", ["スリランカ", "セイロン"]),
    ("np", "ネパール連邦民主共和国", ["ネパール"]),
    ("bt", "ブータン王国", ["ブータン"]),
    ("mv", "モルディブ共和国", ["モルディブ"]),
    ("af", "アフガニスタン・イスラム首長国", ["アフガニスタン"]),
    ("ir", "イラン・イスラム共和国", ["イラン", "ペルシャ"]),
    ("iq", "イラク共和国", ["イラク"]),
    ("sy", "シリア・アラブ共和国", ["シリア"]),
    ("lb", "レバノン共和国", ["レバノン"]),
    ("jo", "ヨルダン・ハシミテ王国", ["ヨルダン"]),
    ("il", "イスラエル国", ["イスラエル"]),
    ("ps", "パレスチナ国", ["パレスチナ"]),
    ("sa", "サウジアラビア王国", ["サウジアラビア"]),
    ("ae", "アラブ首長国連邦", ["UAE", "首長国連邦"]),
    ("kw", "クウェート国", ["クウェート"]),
    ("bh", "バーレーン王国", ["バーレーン"]),
    ("qa", "カタール国", ["カタール"]),
    ("om", "オマーン国", ["オマーン"]),
    ("ye", "イエメン共和国", ["イエメン"]),
    ("tr", "トルコ共和国", ["トルコ", "テュルキエ"]),
    ("cy", "キプロス共和国", ["キプロス"]),
    ("ge", "ジョージア", ["グルジア"]),
    ("am", "アルメニア共和国", ["アルメニア"]),
    ("az", "アゼルバイジャン共和国", ["アゼルバイジャン"]),
    ("kz", "カザフスタン共和国", ["カザフスタン"]),
    ("uz", "ウズベキスタン共和国", ["ウズベキスタン"]),
    ("tm", "トルクメニスタン", []),
    ("kg", "キルギス共和国", ["キルギス", "キルギスタン"]),
    ("tj", "タジキスタン共和国", ["タジキスタン"]),

    # === ヨーロッパ ===
    ("ru", "ロシア連邦", ["ロシア", "ソビエト連邦", "ソ連"]),
    ("ua", "ウクライナ", []),
    ("by", "ベラルーシ共和国", ["ベラルーシ", "白ロシア"]),
    ("md", "モルドバ共和国", ["モルドバ"]),
    ("pl", "ポーランド共和国", ["ポーランド"]),
    ("cz", "チェコ共和国", ["チェコ", "チェコスロバキア"]),
    ("sk", "スロバキア共和国", ["スロバキア"]),
    ("hu", "ハンガリー", []),
    ("ro", "ルーマニア", []),
    ("bg", "ブルガリア共和国", ["ブルガリア"]),
    ("rs", "セルビア共和国", ["セルビア"]),
    ("hr", "クロアチア共和国", ["クロアチア"]),
    ("si", "スロベニア共和国", ["スロベニア"]),
    ("ba", "ボスニア・ヘルツェゴビナ", ["ボスニア"]),
    ("me", "モンテネグロ", []),
    ("mk", "北マケドニア共和国", ["北マケドニア", "マケドニア"]),
    ("al", "アルバニア共和国", ["アルバニア"]),
    ("xk", "コソボ共和国", ["コソボ"]),
    ("de", "ドイツ連邦共和国", ["ドイツ", "西ドイツ"]),
    ("at", "オーストリア共和国", ["オーストリア"]),
    ("ch", "スイス連邦", ["スイス"]),
    ("li", "リヒテンシュタイン公国", ["リヒテンシュタイン"]),
    ("fr", "フランス共和国", ["フランス"]),
    ("be", "ベルギー王国", ["ベルギー"]),
    ("nl", "オランダ王国", ["オランダ", "ネーデルランド"]),
    ("lu", "ルクセンブルク大公国", ["ルクセンブルク"]),
    ("gb", "グレートブリテン及び北部アイルランド連合王国", ["イギリス", "英国", "UK"]),
    ("ie", "アイルランド", []),
    ("is", "アイスランド共和国", ["アイスランド"]),
    ("no", "ノルウェー王国", ["ノルウェー"]),
    ("se", "スウェーデン王国", ["スウェーデン"]),
    ("fi", "フィンランド共和国", ["フィンランド"]),
    ("dk", "デンマーク王国", ["デンマーク"]),
    ("ee", "エストニア共和国", ["エストニア"]),
    ("lv", "ラトビア共和国", ["ラトビア"]),
    ("lt", "リトアニア共和国", ["リトアニア"]),
    ("it", "イタリア共和国", ["イタリア"]),
    ("es", "スペイン王国", ["スペイン"]),
    ("pt", "ポルトガル共和国", ["ポルトガル"]),
    ("gr", "ギリシャ共和国", ["ギリシャ", "ヘラス"]),
    ("mt", "マルタ共和国", ["マルタ"]),
    ("sm", "サンマリノ共和国", ["サンマリノ"]),
    ("va", "バチカン市国", ["バチカン"]),
    ("mc", "モナコ公国", ["モナコ"]),
    ("ad", "アンドラ公国", ["アンドラ"]),

    # === 北米・中米・カリブ ===
    ("us", "アメリカ合衆国", ["アメリカ", "米国", "米合衆国", "USA"]),
    ("ca", "カナダ", []),
    ("mx", "メキシコ合衆国", ["メキシコ"]),
    ("gt", "グアテマラ共和国", ["グアテマラ"]),
    ("bz", "ベリーズ", []),
    ("hn", "ホンジュラス共和国", ["ホンジュラス"]),
    ("sv", "エルサルバドル共和国", ["エルサルバドル"]),
    ("ni", "ニカラグア共和国", ["ニカラグア"]),
    ("cr", "コスタリカ共和国", ["コスタリカ"]),
    ("pa", "パナマ共和国", ["パナマ"]),
    ("cu", "キューバ共和国", ["キューバ"]),
    ("jm", "ジャマイカ", []),
    ("ht", "ハイチ共和国", ["ハイチ"]),
    ("do", "ドミニカ共和国", []),
    ("dm", "ドミニカ国", []),
    ("tt", "トリニダード・トバゴ共和国", ["トリニダード・トバゴ"]),
    ("bb", "バルバドス", []),
    ("lc", "セントルシア", []),
    ("vc", "セントビンセント及びグレナディーン諸島", []),
    ("gd", "グレナダ", []),
    ("ag", "アンティグア・バーブーダ", []),
    ("kn", "セントクリストファー・ネービス", []),
    ("bs", "バハマ国", ["バハマ"]),

    # === 南米 ===
    ("br", "ブラジル連邦共和国", ["ブラジル"]),
    ("ar", "アルゼンチン共和国", ["アルゼンチン"]),
    ("cl", "チリ共和国", ["チリ"]),
    ("co", "コロンビア共和国", ["コロンビア"]),
    ("ve", "ベネズエラ・ボリバル共和国", ["ベネズエラ"]),
    ("pe", "ペルー共和国", ["ペルー"]),
    ("ec", "エクアドル共和国", ["エクアドル"]),
    ("bo", "ボリビア多民族国", ["ボリビア"]),
    ("py", "パラグアイ共和国", ["パラグアイ"]),
    ("uy", "ウルグアイ東方共和国", ["ウルグアイ"]),
    ("gy", "ガイアナ共和国", ["ガイアナ"]),
    ("sr", "スリナム共和国", ["スリナム"]),

    # === アフリカ ===
    ("eg", "エジプト・アラブ共和国", ["エジプト"]),
    ("ly", "リビア", []),
    ("tn", "チュニジア共和国", ["チュニジア"]),
    ("dz", "アルジェリア民主人民共和国", ["アルジェリア"]),
    ("ma", "モロッコ王国", ["モロッコ"]),
    ("mr", "モーリタニア・イスラム共和国", ["モーリタニア"]),
    ("ml", "マリ共和国", ["マリ"]),
    ("bf", "ブルキナファソ", []),
    ("ne", "ニジェール共和国", ["ニジェール"]),
    ("td", "チャド共和国", ["チャド"]),
    ("sd", "スーダン共和国", ["スーダン"]),
    ("ss", "南スーダン共和国", ["南スーダン"]),
    ("er", "エリトリア国", ["エリトリア"]),
    ("et", "エチオピア連邦民主共和国", ["エチオピア"]),
    ("ke", "ケニア共和国", ["ケニア"]),
    ("ug", "ウガンダ共和国", ["ウガンダ"]),
    ("tz", "タンザニア連合共和国", ["タンザニア"]),
    ("rw", "ルワンダ共和国", ["ルワンダ"]),
    ("bi", "ブルンジ共和国", ["ブルンジ"]),
    ("cd", "コンゴ民主共和国", ["民主コンゴ"]),
    ("cg", "コンゴ共和国", []),
    ("cf", "中央アフリカ共和国", ["中央アフリカ"]),
    ("cm", "カメルーン共和国", ["カメルーン"]),
    ("ng", "ナイジェリア連邦共和国", ["ナイジェリア"]),
    ("gh", "ガーナ共和国", ["ガーナ"]),
    ("bj", "ベナン共和国", ["ベナン"]),
    ("tg", "トーゴ共和国", ["トーゴ"]),
    ("ci", "コートジボワール共和国", ["コートジボワール", "象牙海岸"]),
    ("lr", "リベリア共和国", ["リベリア"]),
    ("sl", "シエラレオネ共和国", ["シエラレオネ"]),
    ("gn", "ギニア共和国", ["ギニア"]),
    ("gw", "ギニアビサウ共和国", ["ギニアビサウ"]),
    ("sn", "セネガル共和国", ["セネガル"]),
    ("gm", "ガンビア共和国", ["ガンビア"]),
    ("cv", "カーボベルデ共和国", ["カーボベルデ"]),
    ("zm", "ザンビア共和国", ["ザンビア"]),
    ("mw", "マラウイ共和国", ["マラウイ"]),
    ("mz", "モザンビーク共和国", ["モザンビーク"]),
    ("zw", "ジンバブエ共和国", ["ジンバブエ"]),
    ("bw", "ボツワナ共和国", ["ボツワナ"]),
    ("na", "ナミビア共和国", ["ナミビア"]),
    ("za", "南アフリカ共和国", ["南アフリカ"]),
    ("ls", "レソト王国", ["レソト"]),
    ("sz", "エスワティニ王国", ["エスワティニ", "スワジランド"]),
    ("ao", "アンゴラ共和国", ["アンゴラ"]),
    ("ga", "ガボン共和国", ["ガボン"]),
    ("gq", "赤道ギニア共和国", ["赤道ギニア"]),
    ("st", "サントメ・プリンシペ民主共和国", ["サントメ・プリンシペ"]),
    ("km", "コモロ連合", ["コモロ"]),
    ("mg", "マダガスカル共和国", ["マダガスカル"]),
    ("mu", "モーリシャス共和国", ["モーリシャス"]),
    ("sc", "セーシェル共和国", ["セーシェル"]),
    ("dj", "ジブチ共和国", ["ジブチ"]),
    ("so", "ソマリア連邦共和国", ["ソマリア"]),

    # === オセアニア ===
    ("au", "オーストラリア連邦", ["オーストラリア"]),
    ("nz", "ニュージーランド", []),
    ("pg", "パプアニューギニア独立国", ["パプアニューギニア"]),
    ("fj", "フィジー共和国", ["フィジー"]),
    ("sb", "ソロモン諸島", []),
    ("vu", "バヌアツ共和国", ["バヌアツ"]),
    ("ws", "サモア独立国", ["サモア", "西サモア"]),
    ("to", "トンガ王国", ["トンガ"]),
    ("ki", "キリバス共和国", ["キリバス"]),
    ("tv", "ツバル", []),
    ("nr", "ナウル共和国", ["ナウル"]),
    ("pw", "パラオ共和国", ["パラオ"]),
    ("fm", "ミクロネシア連邦", ["ミクロネシア"]),
    ("mh", "マーシャル諸島共和国", ["マーシャル諸島"]),
    ("ck", "クック諸島", []),
    ("nu", "ニウエ", []),
]


def main():
    rows = []
    for country_id, canonical_name, aliases in COUNTRIES:
        # canonical
        rows.append({
            "country_id":     country_id,
            "canonical_name": canonical_name,
            "name":           canonical_name,
            "name_type":      "canonical",
        })
        # aliases
        for alias in aliases:
            rows.append({
                "country_id":     country_id,
                "canonical_name": canonical_name,
                "name":           alias,
                "name_type":      "alias",
            })

    os.makedirs(os.path.dirname(OUT_PATH), exist_ok=True)
    with open(OUT_PATH, 'w', encoding='utf-8', newline='') as f:
        writer = csv.DictWriter(f, fieldnames=["country_id", "canonical_name", "name", "name_type"])
        writer.writeheader()
        writer.writerows(rows)

    print(f"Generated {len(rows)} rows ({len(COUNTRIES)} countries) → {OUT_PATH}")

    # 重複チェック
    names = [r["name"] for r in rows]
    dups = [n for n in names if names.count(n) > 1]
    if dups:
        print(f"WARNING: duplicate names: {set(dups)}")
    else:
        print("No duplicate names found.")


if __name__ == '__main__':
    main()
